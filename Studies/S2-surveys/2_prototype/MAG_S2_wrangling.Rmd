---
title: "MAG — S2 WRANGLING EDA"
author: "ANONYMIZED"
date: "2024-02-04"
output:
  html_document:
    theme: flatly
    code_folding: hide
    fig_caption: yes
    number_sections: yes
    toc: yes
    toc_float:
      collapsed: yes
      smooth_scroll: yes
    toc_depth: 5
  pdf_document:
    toc: yes
    toc_depth: '4'
always_allow_html: yes
font-family: DejaVu Sans
mainfont: DejaVu Sans
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

#UTILITIES
library(Hmisc) # %nin% operator
library(tidyverse) #all the things
library(magrittr) #special pipes like %<>%
library(summarytools) #data quality
library(lubridate) #dealing with dates

#VIZ
library(kableExtra) #printing tables
library(ggformula) #regression syntax viz
# library(vcd) #mosaic plots
# library(vcdExtra) #mosaic plot helpers
library(ggstatsplot) #dummies
library(GGally) #extends ggplot for EDA 
library(ggeasy) #easy labelling
library(ggh4x) #guides [dual axes]
library(patchwork) #multi-plot layout

#MODELLING
library(jtools) #Social Science regression utilities
library(easystats) #modelling helpers
library(see)
library(sjPlot)
library(lme4)
library(lmerTest) #for CIs in glmer

options(readr.show_col_types = FALSE) #don't show coltypes on read_csv

#POWER ANALYSIS & SIMULATION
# library(pwr)
# library(simr)

#ARF ONLY — MANUAL RUN
# setwd("~/Code/IXN-Characterizing_Interaction/IXN-D_Characterizing_Interaction/ANALYSIS")

```

# WRANGLING

Initial data were collected via Qualtrics surveys named `MAG_S2_PROLIFIC-DATACOLLAR_0` and `MAG_S2_PROLIFIC-DATACOLLAR_0`, each presenting participants with one common graph ("block 0", `STIMULUS = B0-0`) and four subsequent graphs in random order ("block 1"). The 24 stimuli are organized in 6 blocks, and we started by collecting data for block 1 to test data quality and runtime of the survey instrument.

Notes on Qualtrics Survey Status

In Qualtrics, when a survey is:

-   **abandoned**; Finished = False and Progress \< 100%

-   **fails consent or pre-screening**, Finished = TRUE, Progress = 100%, Q_TerminateFlag = "Screened"

-   **complete**; Finished = TRUE, Progress = 100%

```{r WRANGLING, message=FALSE, warning=FALSE}

#### RAW DATA ####################################################################
# will always be the unaltered version of imported data
# 1 row per subject 
df_raw_datacollar <- read_csv("data/input/CLEAN_MAG_S2_PROLIFIC-DATACOLLAR_B1.csv", col_names = TRUE)
df_raw_bluecollar <- read_csv("data/input/CLEAN_MAG_S2_PROLIFIC-BLUECOLLAR_B1.csv", col_names = TRUE)
df_raw_b2 <- read_csv("data/input/CLEAN_MAG_S2_PROLIFIC-GENERAL_B2.csv", col_names = TRUE)
df_raw_b3 <- read_csv("data/input/CLEAN_MAG_S2_PROLIFIC-GENERAL_B3.csv", col_names = TRUE)
df_raw_b4 <- read_csv("data/input/CLEAN_MAG_S2_PROLIFIC-GENERAL_B4.csv", col_names = TRUE)
df_raw_b5 <- read_csv("data/input/CLEAN_MAG_S2_PROLIFIC-GENERAL_B5.csv", col_names = TRUE)
df_raw_b6 <- read_csv("data/input/CLEAN_MAG_S2_PROLIFIC-GENERAL_B6.csv", col_names = TRUE)

# drop first two rows (qualtrics_specs)
df_raw_datacollar <- df_raw_datacollar[-c(1:2),]
df_raw_bluecollar <- df_raw_bluecollar[-c(1:2),]
df_raw_b2 <- df_raw_b2[-c(1:2),]
df_raw_b3 <- df_raw_b3[-c(1:2),]
df_raw_b4 <- df_raw_b4[-c(1:2),]
df_raw_b5 <- df_raw_b5[-c(1:2),]
df_raw_b6 <- df_raw_b6[-c(1:2),]

#ADD DUMMY COLS TO DATA/BLUE COLLAR PILOT DATA 
# necessary b/c pilot (block 1) did not have chart_action behavioural question
# x <- compare_df_cols(df_raw_b2, df_raw_pilot)
df_raw_pilot <- rbind(df_raw_datacollar, df_raw_bluecollar) %>% 
  mutate(
    '0_Q_B0_CHART_ACTION' = NA,
    '1_Q_B1_CHART_ACTION' = NA,
    '1_Q_B2_CHART_ACTION' = NA,
    '1_Q_B3_CHART_ACTION' = NA,
    '1_Q_B4_CHART_ACTION' = NA,
    '1_Q_B5_CHART_ACTION' = NA,
    '1_Q_B6_CHART_ACTION' = NA,
    '2_Q_B1_CHART_ACTION' = NA,
    '2_Q_B2_CHART_ACTION' = NA,
    '2_Q_B3_CHART_ACTION' = NA,
    '2_Q_B4_CHART_ACTION' = NA,
    '2_Q_B5_CHART_ACTION' = NA,
    '2_Q_B6_CHART_ACTION' = NA,
    '3_Q_B1_CHART_ACTION' = NA,
    '3_Q_B2_CHART_ACTION' = NA,
    '3_Q_B3_CHART_ACTION' = NA,
    '3_Q_B4_CHART_ACTION' = NA,
    '3_Q_B5_CHART_ACTION' = NA,
    '3_Q_B6_CHART_ACTION' = NA,
    '4_Q_B1_CHART_ACTION' = NA,
    '4_Q_B2_CHART_ACTION' = NA,
    '4_Q_B3_CHART_ACTION' = NA,
    '4_Q_B4_CHART_ACTION' = NA,
    '4_Q_B5_CHART_ACTION' = NA,
    '4_Q_B6_CHART_ACTION' = NA
  )

df_raw <- rbind(df_raw_pilot,df_raw_b2, df_raw_b3, df_raw_b4, df_raw_b5, df_raw_b6)
rm(df_raw_datacollar, df_raw_bluecollar, df_raw_b2, df_raw_b3, df_raw_b4, df_raw_b5, df_raw_b6, df_raw_pilot)

#### MASTER WIDE FORMAT DATA FRAME [1 row / qualtrics submission] ################
df_data <- df_raw %>% 
  select(
    -EndDate, -IPAddress, -RecordedDate,
    -RecipientLastName, -RecipientFirstName, -RecipientEmail,
    -ExternalReference, -LocationLatitude, -LocationLongitude, 
    -DistributionChannel, -UserLanguage, -Q_RecaptchaScore,
    -P_BROWSER_Version, -P_BROWSER_Resolution, 
    -CONSENT, -ELIGIBILITY, 
    -randomize_common, -stimulus_common, #hidden q that controls common stimulus url
    -FL_14_DO, #not actually randomization order
    -contains("First Click"), -contains("Last Click"), -contains("Click Count"),
    -T_EMAIL, -T_BROWSER_Version, -T_BROWSER_Resolution, 
    -D_politicalParty_DO, 
    -ID_PROLIFIC, -ID_STUDY, -ID_SESSION #redundant to other cols 
  ) %>% 
  rename(
    duration.sec = `Duration (in seconds)`,
    EndState = End_State, 
    TerminateFlag = Q_TerminateFlag,
    Source = Status, #where the survey originated from (should not be preview or test)
    PLATFORM = Q_PLATFORM,
    ID.Qualtrics = ResponseId,
    ID.Prolific = PROLIFIC_PID,
    ID.Study = STUDY_ID,
    ID.Session = SESSION_ID,
    P_BROWSER_OS = `P_BROWSER_Operating System`,
    T_BROWSER_OS = `T_BROWSER_Operating System`,
    SCREEN_workFunction_TEXT = SCREEN_workFunction_22_TEXT, 
    SCREEN_socialMedia_TEXT = SCREEN_socialMedia_18_TEXT,
    D_politicalParty_OTHER = D_politicalParty_4_TEXT,
    D_politicsSocial = D_politicsSocial_1,
    D_politicsFiscal = D_politicsFiscal_2
 ) %>% 
  mutate(
# STUDY IDS
# 65ceb65b05030d95c598ef1b - blue collar 
# 65c53fd727dceff9fd360b09 - data collar 
    D_politicsSocial = as.numeric(D_politicsSocial),
    D_politicsFiscal = as.numeric(D_politicsFiscal),
    #HARHDCODED PROLIFIC SAMPLE IDS 
    ID.Study = factor(ID.Study, 
                      levels = c("65c53fd727dceff9fd360b09", #datacollar
                                 "65ceb65b05030d95c598ef1b", #bluecollar
                                 "65d8f06b624798854f7f6872", #block2
                                 "65e3544f7e2772d49871027c", #block3
                                 "65e3df9c189950bea65663f4", #block4
                                 "65e3d5b62886fbf7104e594f", #block5
                                 "65e125ddf213381ee6b67177"), #block6
                      labels = c("datacollar","bluecollar","block2","block3","block4","block5","block6")),
    # StartDate = mdy_hm(StartDate),
    duration.sec = as.numeric(duration.sec), #weird booleans should only be for the test generator
    duration.min = round(duration.sec/60,2),
    Progress = as.numeric(Progress), 
    D_education = factor( D_education,
                          levels = c(
                            "NA",
                            "Some high school or less",
                            "High school diploma or GED",
                            "Associates or technical degree",
                            "Some college, but no degree",
                            "Graduate or professional degree (MA, MS, MBA, PhD, JD, MD, DDS etc.)"
                          ), 
                          labels = c(
                            "NA",
                            "< HS",
                            "HS/GED",
                            "Associates",
                            "Some college",
                            "Grad/Proff"
                          )
      ),
    D_politicalParty = factor(D_politicalParty, levels = c("NA", "Independent", "Democrat", "Republican", "Other")),
    D_age = factor(D_age, 
                   levels = c("25-34 years old" ,
                              "18-24 years old" ,
                              "45-54 years old" ,
                              "35-44 years old" ,
                              "65+ years old"   ,
                              "55-64 years old"), 
                   labels = c("25-34", "18-24", "45-54","35-44","65+ years","55-64"))
  ) %>%
  rename_at(
  #REPLACE RANDOM TRAILING _1 AND _65 FROM QUALTRICS
    vars(contains('_65')), funs(sub('_65', '', .))
  ) %>% 
  rename_at(
    vars(contains('_1')), funs(sub('_1', '', .))
  ) %>% 
  rename_at(
   vars(contains('_Page Submit')), funs(sub('_Page Submit', '', .))
  ) %>% 
  rename_at( #CHANGE DETAIL QUESTION DELIMITER FOR PIVOT PURPOSES 
   vars(contains('_CHART_')), funs(sub('_CHART_', '_CHART-', .))
  ) %>% 
  rename_at( #CHANGE DETAIL QUESTION DELIMITER FOR PIVOT PURPOSES 
   vars(contains('_MAKER_')), funs(sub('_MAKER_', '_MAKER-', .))
  ) %>% 
  rename_at( #CHANGE DETAIL QUESTION DELIMITER FOR PIVOT PURPOSES 
   vars(contains('_AGE_')), funs(sub('_AGE_', '_AGE-', .))
  ) %>% 
  rename_at( #CHANGE DETAIL QUESTION DELIMITER FOR PIVOT PURPOSES 
   vars(contains('_GENDER_')), funs(sub('_GENDER_', '_GENDER-', .))
  ) %>% 
  rename_at( #CHANGE DETAIL QUESTION DELIMITER FOR PIVOT PURPOSES 
   vars(contains('_TOOL_')), funs(sub('_TOOL_', '_TOOL-', .))
   ) %>% 
  select ( #reodering
    ID.Qualtrics, ID.Prolific:ID.Session, 
    Source, Progress, Finished, EndState, TerminateFlag, 
    StartDate, duration.min, PLATFORM,
    P_BROWSER_Browser, P_BROWSER_OS, T_BROWSER_Browser, T_BROWSER_OS, 
    D_gender:D_politicsFiscal, SCREEN_workMethod:SCREEN_socialMedia_TEXT, 
    PURPOSE, FEEDBACK , 
    `0_Q_B0_ENCOUNTER`:`4_Q_B6_CHART-ACTION`
  )  %>% 
  mutate ( #set factors 
    ID.Qualtrics = factor(ID.Qualtrics),
    ID.Prolific = factor(ID.Prolific),
    # ID.Study = factor(ID.Study),
    ID.Session = factor(ID.Session),
    PLATFORM = factor(PLATFORM),
    Source = factor(Source),
    Finished = as.logical(Finished),
    TerminateFlag = factor(TerminateFlag)
  ) 

#### SEGREGATE PARTICIPANTS WHO DID NOT COMPLETE ###############################
## [1 row / qualtrics submission] ################
## NOTE it is common for prolific participants to fail the 
## screening verification, and then try again but change their 
## screening verification answers (ie. one prolific ID for multiple qualrics IDs)
df_exclude <- df_data %>% 
  filter( 
    !is.na(TerminateFlag) | Finished == FALSE | EndState != "COMPLETE"  
  ) %>% 
  select(
    ID.Qualtrics, ID.Prolific, ID.Study, Source, Progress, 
    Finished, TerminateFlag, EndState) %>% 
  mutate(
    EndState = ifelse( (Progress < 100), "abandoned", EndState)
  )



#### MASTER VALID DATA [WIDE] 1 row per qualtrics entry #########################
## [1 row / qualtrics submission] ################
df_data <- df_data %>% filter(
  ID.Qualtrics %nin% df_exclude$ID.Qualtrics
  # (Finished == TRUE ) & is.na(TerminateFlag)
)

#sanity check === SHOULD BE O
#no qualtrics surveys in good data that weren't finished
print("Number of Qualtrics entries in df_data AND nofinish? [should be 0]")
sum(df_data$ID.Qualtrics %in% df_exclude$ID.Qualtrics)

#sanity check === SHOULD BE O
#no duplicated PROLIFIC ids in good data 
print("Number of Prolific IDs duplicated in df_data print [should be 0]")
sum(duplicated(df_data$ID.Prolific))

  
#### QUESTION LEVEL DATA FRAME (LONG) ##########################
# unravel ALL the way down to questions 
# 1 row per participant-graph-question
df_questions <- df_data %>% 
  select(
  ID.Qualtrics:ID.Study, PLATFORM, 
  contains("_Q_"), contains("loop")
) %>% 
  pivot_longer( #PIVOT ON stimulus
  cols = contains("_Q_"),
  names_to = c("stimulus","dummy","BLOCK","QUESTION"),
  values_to = c("value"),
  names_sep = "_"
) %>% select(-dummy) %>% 
  unite(
   BLOCK:stimulus, col="STIMULUS", sep="-", remove=FALSE
) %>% 
  mutate(
    BLOCK = factor(BLOCK),
    STIMULUS = factor(STIMULUS),
    QUESTION = str_replace_all(QUESTION,"-","_"),
    QUESTION = factor(QUESTION)
) %>% 
  select(-stimulus) %>% filter(!is.na(value))


#### MULTI-SELECT QUESTIONS  ##########################

## DF_TOOLS 
# 1 ROW per PARTICIPANT X STIMULUS X tool_id selection 
# tool_id is a multiselect field 
df_tools <- df_questions %>% 
  # select(ID.Prolific, QUESTION, value) %>%
  filter(QUESTION == "TOOL_ID") %>% 
  mutate(QUESTION = fct_drop(QUESTION)) %>% 
  separate_longer_delim(
    cols = value,
    delim = ","
  ) %>% 
  mutate(TOOL_ID = as_factor(value)) %>% 
  select(-value,-QUESTION)

## DF_ACTIONS 
# 1 ROW per PARTICIPANT X STIMULUS X chart_action selection 
# chart_action is a multiselect field 
df_actions <- df_questions %>% 
  filter(QUESTION == "CHART_ACTION") %>% 
  mutate(QUESTION = fct_drop(QUESTION)) %>% 
  separate_longer_delim(
    cols = value,
    delim = ","
  ) %>% 
  mutate(CHART_ACTION = as_factor(value)) %>% 
  select(-value,-QUESTION)

#### CHART LEVEL DATA FRAME (LONG) ##########################
# 1 row per participant X graph 
# unnest https://stackoverflow.com/questions/58035452/pivot-wider-outputs-s3-vctrs-list-of-objects
df_graphs_full <- df_questions %>% 
  pivot_wider(
    names_from = QUESTION,
    values_from = value 
  ) %>%  
  tidyr::unnest() %>%  # handle r coerces values to lists
  mutate(
    across(contains("MAKER_ID") | contains("MAKER_GENDER") | contains("MAKER_AGE"), factor),
    across(contains("_CONF") | contains("_LATENCY"), as.numeric),
    across(MAKER_DESIGN:MAKER_TRUST, as.numeric),
    across(CHART_LIKE:CHART_TRUST, as.numeric),
    ENCOUNTER = factor(ENCOUNTER),
    loop_number = as.numeric(loop_number),
    loop_number = ifelse(is.na(loop_number), 0, loop_number),
    MAKER_LATENCY = round(MAKER_LATENCY/60,2), #CHANGE TO MINS
    CHART_LATENCY = round(CHART_LATENCY/60,2), #CHANGE TO MINS
    MAKER_ID = factor( MAKER_ID,levels = c("business", "political", "education","news","organization","individual"))
  )

## SUBSET OF COLUMNS EXCLUDING THE FREE RESPONSES and MULTISELECT
df_graphs <- df_graphs_full %>% 
  select( !is.character)

#### CHART LEVEL DATA FRAME (LONG) FOR QDA (incl demographics) ##################
# 1 ROW / participant X GRAPH including demographics 
# UNRAVEL TO QUESTIONS
df_qda <- df_data %>% 
  # select(
  # ID.Qualtrics:ID.Study, PLATFORM, 
  # contains("_Q_"), contains("loop")
# ) %>% 
  pivot_longer( #PIVOT ON stimulus
  cols = contains("_Q_"),
  names_to = c("stimulus","dummy","BLOCK","QUESTION"),
  values_to = c("value"),
  names_sep = "_"
) %>% select(-dummy) %>% 
  unite(
   BLOCK:stimulus, col="STIMULUS", sep="-", remove=FALSE
) %>% 
  mutate(
    BLOCK = factor(BLOCK),
    STIMULUS = factor(STIMULUS),
    QUESTION = str_replace_all(QUESTION,"-","_"),
    QUESTION = factor(QUESTION)
) %>% 
  select(-stimulus) %>% 
# RE-RAVEL UP TO STIMULI
  filter(!is.na(value)) %>% 
   pivot_wider(
    names_from = QUESTION,
    values_from = value 
  ) %>%  
  tidyr::unnest() %>%  # handle r coerces values to lists
  mutate(
    across(contains("MAKER_ID") | contains("MAKER_GENDER") | contains("MAKER_AGE"), factor),
    across(contains("_CONF") | contains("_LATENCY"), as.numeric),
    across(MAKER_DESIGN:MAKER_TRUST, as.numeric),
    across(CHART_LIKE:CHART_TRUST, as.numeric),
    ENCOUNTER = factor(ENCOUNTER),
    loop_number = as.numeric(loop_number),
    loop_number = ifelse(is.na(loop_number), 0, loop_number),
    MAKER_LATENCY = round(MAKER_LATENCY/60,2), #CHANGE TO MINS
    CHART_LATENCY = round(CHART_LATENCY/60,2) #CHANGE TO MINS
  )
#WRITE A CSV FILE AS THE BASIS FOR THE QUALITATIVE DATA ANALYSIS
write.csv(df_qda, file = "data/output/df_qda.csv", na="")


#CHECK BLOCKS PER PARTICIPANT
# every participant should have 2 blocks
check_subject_blocks <- df_questions %>%
  group_by(ID.Qualtrics) %>% summarise(
    n_block = length(unique(BLOCK))
  )
all(check_subject_blocks$n_block==2)
  

#CHECK STIMULI PER PARTICIPANT
# every participant should have 5 graphs
check_subject_graphs <- df_questions %>% 
  group_by(ID.Qualtrics) %>%summarise(
    n_graphs = length(unique(STIMULUS))
  ) #each participant should have five graphs
all(check_subject_graphs$n_graphs==5)



# title = "Participants by Condition and Data Collection Modality"
# cols = c("Control Condition","Impasse Condition","Total for Period")
print("Number of abandoned/screened/rejected attempts")
table(df_exclude$ID.Study)
print("Number of successful surveys")
table(df_data$ID.Study)
# cont %>% addmargins() %>% kbl(caption = title, col.names = cols) %>%  kable_classic()



#CLEANUP
rm(check_subject_blocks, check_subject_graphs, df_graphs_qda)


#TEMP RECODE PILOT STUDYID
df_graphs <- df_graphs %>% mutate(
  ID.Study = recode(ID.Study, "datacollar"="block1", "bluecollar"="block1")
)

df_data <- df_data %>% mutate(
  ID.Study = recode(ID.Study, "datacollar"="block1", "bluecollar"="block1")
)



# `r nrow(df_raw)` submissions were received via Qualtrics (`r nrow(df_master %>% filter(ID.Study=="datacollar"))` data-collar, `r nrow(df_master %>% filter(ID.Study=="bluecollar"))` blue-collar). Of these submissions, `r nrow(df_nofinish)` were incomplete (`r nrow(df_nofinish %>% filter(EndState == "abandoned"))` surveys abandoned, and `r nrow(df_nofinish %>% filter(TerminateFlag == "Screened"))` failed screening questions.
# 
# Dataframe descriptions:
# 
# -   `df_raw` is raw data from each qualtrics survey, combined; 1 row per Qualtrics submission ( `r nrow(df_raw)` total qualtrics attempts)
# 
# -   `df_raw_clean` is wrangled data from raw, with only relevant columns; 1 row per Qualtrics submission (`r nrow(df_master)` total qualtrics attempts)
# 
# -   `df_nofinish` is data for invalid submissions (abandonded or screened out due to not matching the pre-screening questions in prolific) (`r nrow(df_nofinish)` incomplete submissions) NOTE that these do not indicate unique participants. In some instances, the same `ID.Prolific` is associated with multiple (incomplete) attempts.
# 
# -   `df_data` is data for completed, valid submissions; 1 row per complete Qualtrics submission = 1 participant (`r nrow(df_data)` total valid submissions)
# 
# -   `df_graphs` is valid data pivoted long *without* free response questions; 1 row per participant X graph (`r nrow(df_graphs)`) participant-graph records)
# 
# -   `df_graphs_full` is valid data pivoted long *including* free response questions; 1 row per participant X graph (`r nrow(df_graphs_full)`) participant-graph records)
# 
# -   `df_subjects` is valid data (1 row per participant)


n_blocks = 4
```

# PROFILING

## Descriptives

```{r}

df_graphs%>% summarytools::dfSummary(
             varnumbers = FALSE,
             plain.ascii  = FALSE,
             graph.magnif = 0.75,
             style        = "grid",
             tmp.img.dir  = "temp",
             missing.col = FALSE, 
             method = "render"
)


```

## Demographics

```{r}


# SURVEY RESPONSE TIME 
ggplot(data = df_data, aes( x = duration.min, fill = ID.Study)) + 
  geom_density(alpha = 0.5) + 
  labs( title = "TOTAL Response Time by Sample") + 
  easy_add_legend_title("Sample") + 
  theme_minimal()


# MAKER PAGE RESPONSE TIME 
ggplot(df_graphs, aes(x=STIMULUS, y=MAKER_LATENCY, color=ID.Study)) +
  geom_boxplot(position=position_dodge(0.9))+
  geom_jitter(position=position_jitterdodge(), alpha = 0.3) + 
  labs( title = "MAKER Page Response Time by Sample") + 
  easy_add_legend_title("Sample")+
  theme_minimal() 


# CHART PAGE RESPONSE TIME 
ggplot(df_graphs, aes(x=STIMULUS, y=CHART_LATENCY, color=ID.Study)) +
  geom_boxplot(position=position_dodge(0.9))+
  geom_jitter(position=position_jitterdodge(), alpha = 0.3) + 
  labs( title = "CHART Page Response Time by Sample") + 
  easy_add_legend_title("Sample")+
  theme_minimal() 


# EDUCATION by SAMPLE
ggplot(data = df_data, aes( x = D_education, fill = ID.Study )) + 
  geom_bar(position = position_dodge()) +
  labs( title = "EDUCATION by Sample", x = "") + 
  theme_minimal() + 
  # easy_remove_x_axis() + 
  easy_add_legend_title("Sample")


# AGE by SAMPLE
ggplot(data = df_data, aes( x = D_age, fill = ID.Study )) + 
  geom_bar(position = position_dodge()) +
  labs( title = "AGE by Sample", x = "") + 
  theme_minimal() + 
  # easy_remove_x_axis() + 
  easy_add_legend_title("")


# POLITICAL PARTY 
ggplot(data = df_data, aes( x = D_politicalParty, fill = ID.Study )) + 
  geom_bar(position = position_dodge()) +
  labs( title = "POLITICAL PARTY by Sample", x = "") + 
  theme_minimal() + 
  easy_add_legend_title("")
  

# SOCIAL POLITICAL SAMPLE
vals <- c("block1", "block2","block6")
leftside <- rep("left-leaning",1)
rightside <- rep("right-leaning",1)
g <- ggplot(df_data, aes(x=ID.Study, y=D_politicsSocial, color=ID.Study)) +
  geom_boxplot(position=position_dodge(0.9), width = 0.5)+
  geom_jitter(position=position_jitterdodge(), alpha = 0.3) + 
  labs( title = "SOCIAL VALUES by Sample", 
         y = "Social Politics", x = "") + 
  easy_add_legend_title("Sample") +
  theme_minimal() +
  coord_flip()  
g + guides(
  y = guide_axis_manual(
  breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  breaks = vals, 
  labels = rightside
))  
  

# FISCAL POLITICAL SAMPLE
vals <- c("block1", "block2","block6")
leftside <- rep("left-leaning",1)
rightside <- rep("right-leaning",1)
g <- ggplot(df_data, aes(x=ID.Study, y=D_politicsFiscal, color=ID.Study)) +
  geom_boxplot(position=position_dodge(0.9), width = 0.5)+
  geom_jitter(position=position_jitterdodge(), alpha = 0.3) + 
  labs( title = "FISCAL VALUES by Sample", 
         y = "Fiscal Politics", x = "") + 
  easy_add_legend_title("Sample") +
  theme_minimal() +
  coord_flip()  
g + guides(
  y = guide_axis_manual(
  breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  breaks = vals, 
  labels = rightside
))  
  
# FISCAL (VS) SOCIAL SAMPLE
ggplot(df_data, aes( x = D_politicsFiscal, y= D_politicsSocial, color = ID.Study)) +
  geom_point(alpha = 0.5) + 
  theme_minimal() + 
  easy_add_legend_title("") + 
  labs(title = "Social (vs) Fiscal Political Values by Sample", 
       x = "Fiscal Values (liberal<-->conservative)",
       y = "Social Values (liberal<-->conservative)")
  

#PLATFORM CHOICE
ggplot( df_data, aes( x = PLATFORM, fill = ID.Study)) + 
  geom_bar(position = "dodge") + 
  easy_add_legend_title("") + 
  theme_minimal()


```



# EXPLORATION

SEMANTIC DIFFERENTIALS 
MAKER_DESIGN
MAKER_DATA
MAKER_POLITIC
MAKER_ARGUE
MAKER_SELF
MAKER_ALIGN
MAKER_TRUST

CHART_LIKE
CHART_BEAUTY
CHART_INTENT
CHART_TRUST


multiselect
TOOL_ID
CHART_ACTION

CATEGORICAL
ENCOUNTER
PLATFORM
MAKER_ID
MAKER_GENDER
MAKER_AGE


FREE TEXT
MAKER_DETAIL
MAKER_EXPLAIN
TOOL_DETAIL
CHART_TYPE


CONFIDENCE
MAKER_CONF
GENDER_CONF
AGE_CONF
TOOL_CONF



## BLOCK 0



```{r, message=FALSE, warning=FALSE}

#FILTER DATAFRAME
df <- df_graphs %>% filter(STIMULUS == "B0-0")


# BEHAVIOUR CHOICE
ggplot (df, aes ( x = ENCOUNTER, fill = ID.Study)) + 
  geom_bar(position = "dodge") + 
  labs (title = "BLOCK 0 — BEHAVIOR by Sample", x="") + 
  theme_minimal() +
  easy_remove_legend()



######### MAKER ID AND CONFIDENCE ##############
# MAKER_ID by Sample and BEHAVIOR 
a <- ggplot (df, aes( x = MAKER_ID, fill = ID.Study)) + 
  geom_bar(position = "dodge") +
  facet_grid( df$ENCOUNTER) + 
  labs (x = "") + 
  theme_minimal() +
  easy_remove_legend() 

# MAKER_CONFIDENCE by IDENTIFICATION  
b <- ggplot(df, aes( x = MAKER_ID, y = MAKER_CONF, color = ID.Study)) + 
  # geom_boxplot(position=position_dodge(0.9))+
  geom_jitter(position=position_jitterdodge(), alpha = 0.3) + 
  # labs (title = "MAKER-ID-CONFIDENCE") +
  labs (x = "") + 
  theme_minimal() + 
  easy_remove_legend()


(p <- (a / b )  + plot_annotation(
  title = 'MAKER ID & CONFIDENCE',
  subtitle = '',
  caption = ''))

###################################################


######### MAKER ID AND CONFIDENCE ##############
# MAKER_AGE by Sample and BEHAVIOR 
a <- ggplot (df, aes( x = MAKER_AGE, fill = ID.Study)) + 
  geom_bar(position = "dodge") +
  facet_grid( df$ENCOUNTER) + 
  labs (x = "") + 
  theme_minimal() +
  easy_remove_legend() 

# MAKER_CONFIDENCE by IDENTIFICATION  
b <- ggplot(df, aes( x = MAKER_AGE, y = MAKER_CONF, color = ID.Study)) + 
  # geom_boxplot(position=position_dodge(0.9))+
  geom_jitter(position=position_jitterdodge(), alpha = 0.3) + 
  # labs (title = "MAKER-AGE-CONFIDENCE") +
  labs (x = "") + 
  theme_minimal() + 
  easy_remove_legend()


(p <- (a / b )  + plot_annotation(
  title = 'MAKER AGE & CONFIDENCE',
  subtitle = '',
  caption = ''))

###################################################
```

### B0 MAKER
```{r B0-MAKER}

#FILTER DATAFRAME
df <- df_graphs %>% filter(STIMULUS == "B0-0")

######### MAKER ATTRIBUTES ########################
vals = c("datacollar", "bluecollar")
leftside <- rep ("PROFESSIONAL",n_blocks )
rightside <-rep ("LAYPERSON",n_blocks ) 
b00_m_design <- ggplot(df, aes(y = MAKER_DESIGN, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-DESIGN")

b00_m_data <- ggplot(df, aes(y = MAKER_DATA, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-DATA")


leftside <- rep ("LEFT-WING",n_blocks )
rightside <-rep ("RIGHT-WING",n_blocks ) 
b00_m_politics <- ggplot(df, aes(y = MAKER_POLITIC, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-POLITICS")
  

leftside <- rep ("CONFRONTATIONAL",n_blocks )
rightside <-rep ("DIPLOMATIC",n_blocks ) 
b00_m_argue <- ggplot(df, aes(y = MAKER_ARGUE, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-ARGUE")
  
leftside <- rep ("ALTRUSITC",n_blocks )
rightside <-rep ("SELFISH",n_blocks ) 
b00_m_selfish <- ggplot(df, aes(y = MAKER_SELF, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-SELFISH")


leftside <- rep ("Does NOT",n_blocks )
rightside <-rep ("DOES",n_blocks ) 
b00_m_align <- ggplot(df, aes(y = MAKER_ALIGN, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-SHARES-MY-VALUES")

leftside <- rep ("UNTRUSTWORTHY",n_blocks )
rightside <-rep ("TRUSTWORTHY",n_blocks ) 

b00_m_trust <- ggplot(df, aes(y = MAKER_TRUST, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  # easy_remove_legend() +
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-TRUST")

PLOT_b0_maker <- (b00_m_design / b00_m_data / b00_m_politics / b00_m_argue / b00_m_selfish / b00_m_align / b00_m_trust) + 
  plot_annotation(
    title = "STIMULUS B0 — MILLENIAL PINK PLANTS",
    subtitle =""
  )

PLOT_b0_maker
###################################################




```
## BLOCK 1

### B1-1 MAKER
```{r B1_1-MAKER}

#FILTER DATAFRAME
df <- df_graphs %>% filter(STIMULUS == "B1-1")

######### MAKER ATTRIBUTES ########################
vals = c("datacollar", "bluecollar")
leftside <- rep ("PROFESSIONAL",1 )
rightside <-rep ("LAYPERSON",1 ) 
b11_m_design <- ggplot(df, aes(y = MAKER_DESIGN, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-DESIGN")

b11_m_data <- ggplot(df, aes(y = MAKER_DATA, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  ##breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  ##breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-DATA")


leftside <- rep ("LEFT-WING",1 )
rightside <-rep ("RIGHT-WING",1 ) 
b11_m_politics <- ggplot(df, aes(y = MAKER_POLITIC, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  ##breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  ##breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-POLITICS")
  

leftside <- rep ("CONFRONTATIONAL",1 )
rightside <-rep ("DIPLOMATIC",1 ) 
b11_m_argue <- ggplot(df, aes(y = MAKER_ARGUE, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  ##breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  ##breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-ARGUE")
  
leftside <- rep ("ALTRUSITC",1 )
rightside <-rep ("SELFISH",1 ) 
b11_m_selfish <- ggplot(df, aes(y = MAKER_SELF, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  ##breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  ##breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-SELFISH")


leftside <- rep ("Does NOT",1 )
rightside <-rep ("DOES",1 ) 
b11_m_align <- ggplot(df, aes(y = MAKER_ALIGN, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  ##breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  ##breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-SHARES-MY-VALUES")

leftside <- rep ("UNTRUSTWORTHY",1 )
rightside <-rep ("TRUSTWORTHY",1 ) 
b11_m_trust <- ggplot(df, aes(y = MAKER_TRUST, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  # ##breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  # ##breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-TRUST")


PLOT_b1_1_maker <- (b11_m_design / b11_m_data / b11_m_politics / b11_m_argue / b11_m_selfish / b11_m_align / b11_m_trust) + 
  plot_annotation(
    title = "STIMULUS B1-1 FUSCIA HEAT MAP"
  )

PLOT_b1_1_maker
###################################################



```
### B1-2 MAKER
```{r B1_2-MAKER}

#FILTER DATAFRAME
df <- df_graphs %>% filter(STIMULUS == "B1-2")

######### MAKER ATTRIBUTES ########################
vals = c("datacollar", "bluecollar")
leftside <- rep ("PROFESSIONAL",1 )
rightside <-rep ("LAYPERSON",1 ) 
b12_m_design <- ggplot(df, aes(y = MAKER_DESIGN, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  ##breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  ##breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-DESIGN")

b12_m_data <- ggplot(df, aes(y = MAKER_DATA, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  ##breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  ##breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-DATA")


leftside <- rep ("LEFT-WING",1 )
rightside <-rep ("RIGHT-WING",1 ) 
b12_m_politics <- ggplot(df, aes(y = MAKER_POLITIC, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-POLITICS")
  

leftside <- rep ("CONFRONTATIONAL",1 )
rightside <-rep ("DIPLOMATIC",1 ) 
b12_m_argue <- ggplot(df, aes(y = MAKER_ARGUE, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-ARGUE")
  
leftside <- rep ("ALTRUSITC",1 )
rightside <-rep ("SELFISH",1 ) 
b12_m_selfish <- ggplot(df, aes(y = MAKER_SELF, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-SELFISH")


leftside <- rep ("Does NOT",1 )
rightside <-rep ("DOES",1 ) 
b12_m_align <- ggplot(df, aes(y = MAKER_ALIGN, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-SHARES-MY-VALUES")

leftside <- rep ("UNTRUSTWORTHY",1 )
rightside <-rep ("TRUSTWORTHY",1 ) 
b12_m_trust <- ggplot(df, aes(y = MAKER_TRUST, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-TRUST")


PLOT_b1_2_maker <- (b12_m_design / b12_m_data / b12_m_politics / b12_m_argue / b12_m_selfish / b12_m_align / b12_m_trust) + 
  plot_annotation(
    title = "STIMULUS B1-2 — NEWSY DUAL TIMESERIES"
  )

PLOT_b1_2_maker
###################################################



```


### B1-3 MAKER
```{r B1_3-MAKER}

#FILTER DATAFRAME
df <- df_graphs %>% filter(STIMULUS == "B1-3")

######### MAKER ATTRIBUTES ########################
vals = c("datacollar", "bluecollar")
leftside <- rep ("PROFESSIONAL",1 )
rightside <-rep ("LAYPERSON",1 ) 
b13_m_design <- ggplot(df, aes(y = MAKER_DESIGN, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-DESIGN")

b13_m_data <- ggplot(df, aes(y = MAKER_DATA, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-DATA")


leftside <- rep ("LEFT-WING",1 )
rightside <-rep ("RIGHT-WING",1 ) 
b13_m_politics <- ggplot(df, aes(y = MAKER_POLITIC, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-POLITICS")
  

leftside <- rep ("CONFRONTATIONAL",1 )
rightside <-rep ("DIPLOMATIC",1 ) 
b13_m_argue <- ggplot(df, aes(y = MAKER_ARGUE, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-ARGUE")
  
leftside <- rep ("ALTRUSITC",1 )
rightside <-rep ("SELFISH",1 ) 
b13_m_selfish <- ggplot(df, aes(y = MAKER_SELF, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-SELFISH")


leftside <- rep ("Does NOT",1 )
rightside <-rep ("DOES",1 ) 
b13_m_align <- ggplot(df, aes(y = MAKER_ALIGN, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-SHARES-MY-VALUES")

leftside <- rep ("UNTRUSTWORTHY",1 )
rightside <-rep ("TRUSTWORTHY",1 ) 
b13_m_trust <- ggplot(df, aes(y = MAKER_TRUST, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-TRUST")


PLOT_b1_3_maker <- (b13_m_design / b13_m_data / b13_m_politics / b13_m_argue / b13_m_selfish / b13_m_align / b13_m_trust) + 
  plot_annotation(
    title = "STIMULUS B1-3 — STACKED AMERICAN FLAG"
  )

PLOT_b1_3_maker
###################################################

```
### B1-4 MAKER
```{r B1_4-MAKER}

#FILTER DATAFRAME
df <- df_graphs %>% filter(STIMULUS == "B1-4")

######### MAKER ATTRIBUTES ########################
vals = c("datacollar", "bluecollar")
leftside <- rep ("PROFESSIONAL",1 )
rightside <-rep ("LAYPERSON",1 ) 
b14_m_design <- ggplot(df, aes(y = MAKER_DESIGN, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-DESIGN")

b14_m_data <- ggplot(df, aes(y = MAKER_DATA, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-DATA")


leftside <- rep ("LEFT-WING",1 )
rightside <-rep ("RIGHT-WING",1 ) 
b14_m_politics <- ggplot(df, aes(y = MAKER_POLITIC, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-POLITICS")
  

leftside <- rep ("CONFRONTATIONAL",1 )
rightside <-rep ("DIPLOMATIC",1 ) 
b14_m_argue <- ggplot(df, aes(y = MAKER_ARGUE, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-ARGUE")
  
leftside <- rep ("ALTRUSITC",1 )
rightside <-rep ("SELFISH",1 ) 
b14_m_selfish <- ggplot(df, aes(y = MAKER_SELF, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-SELFISH")


leftside <- rep ("Does NOT",1 )
rightside <-rep ("DOES",1 ) 
b14_m_align <- ggplot(df, aes(y = MAKER_ALIGN, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-SHARES-MY-VALUES")

leftside <- rep ("UNTRUSTWORTHY",1 )
rightside <-rep ("TRUSTWORTHY",1 ) 
b14_m_trust <- ggplot(df, aes(y = MAKER_TRUST, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-TRUST")


PLOT_b1_4_maker <- (b14_m_design / b14_m_data / b14_m_politics / b14_m_argue / b14_m_selfish / b14_m_align / b14_m_trust) + 
  plot_annotation(
    title = "STIMULUS B1-4 — TINY-PEOPLE-GUNS"
  )

PLOT_b1_4_maker
###################################################

```


## BLOCK 2
### B2-1 MAKER
```{r B2_1-MAKER}

#FILTER DATAFRAME
df <- df_graphs %>% filter(STIMULUS == "B2-1")

######### MAKER ATTRIBUTES ########################
vals = c("datacollar", "bluecollar")
leftside <- rep ("PROFESSIONAL",1 )
rightside <-rep ("LAYPERSON",1 ) 
b21_m_design <- ggplot(df, aes(y = MAKER_DESIGN, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-DESIGN")

b21_m_data <- ggplot(df, aes(y = MAKER_DATA, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-DATA")


leftside <- rep ("LEFT-WING",1 )
rightside <-rep ("RIGHT-WING",1 ) 
b21_m_politics <- ggplot(df, aes(y = MAKER_POLITIC, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-POLITICS")
  

leftside <- rep ("CONFRONTATIONAL",1 )
rightside <-rep ("DIPLOMATIC",1 ) 
b21_m_argue <- ggplot(df, aes(y = MAKER_ARGUE, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-ARGUE")
  
leftside <- rep ("ALTRUSITC",1 )
rightside <-rep ("SELFISH",1 ) 
b21_m_selfish <- ggplot(df, aes(y = MAKER_SELF, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-SELFISH")


leftside <- rep ("Does NOT",1 )
rightside <-rep ("DOES",1 ) 
b21_m_align <- ggplot(df, aes(y = MAKER_ALIGN, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-SHARES-MY-VALUES")

leftside <- rep ("UNTRUSTWORTHY",1 )
rightside <-rep ("TRUSTWORTHY",1 ) 

b21_m_trust <-ggplot(df, aes(y = MAKER_TRUST, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-TRUST")


PLOT_b2_1_maker <- (b21_m_design / b21_m_data / b21_m_politics / b21_m_argue / b21_m_selfish / b21_m_align / b21_m_trust) + 
  plot_annotation(
    title = "STIMULUS B2-1 ECONOMIST AREA BLUES"
  )

PLOT_b2_1_maker
###################################################



```
### B2-2 MAKER
```{r B2_2-MAKER}

#FILTER DATAFRAME
df <- df_graphs %>% filter(STIMULUS == "B2-2")

######### MAKER ATTRIBUTES ########################
vals = c("datacollar", "bluecollar")
leftside <- rep ("PROFESSIONAL",1 )
rightside <-rep ("LAYPERSON",1 ) 
b22_m_design <- ggplot(df, aes(y = MAKER_DESIGN, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-DESIGN")

b22_m_data <- ggplot(df, aes(y = MAKER_DATA, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-DATA")


leftside <- rep ("LEFT-WING",1 )
rightside <-rep ("RIGHT-WING",1 ) 
b22_m_politics <- ggplot(df, aes(y = MAKER_POLITIC, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-POLITICS")
  

leftside <- rep ("CONFRONTATIONAL",1 )
rightside <-rep ("DIPLOMATIC",1 ) 
b22_m_argue <- ggplot(df, aes(y = MAKER_ARGUE, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-ARGUE")
  
leftside <- rep ("ALTRUSITC",1 )
rightside <-rep ("SELFISH",1 ) 
b22_m_selfish <- ggplot(df, aes(y = MAKER_SELF, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-SELFISH")


leftside <- rep ("Does NOT",1 )
rightside <-rep ("DOES",1 ) 
b22_m_align <- ggplot(df, aes(y = MAKER_ALIGN, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-SHARES-MY-VALUES")

leftside <- rep ("UNTRUSTWORTHY",1 )
rightside <-rep ("TRUSTWORTHY",1 ) 
b22_m_trust <- ggplot(df, aes(y = MAKER_TRUST, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-TRUST")


PLOT_b2_2_maker <- (b22_m_design / b22_m_data / b22_m_politics / b22_m_argue / b22_m_selfish / b22_m_align / b22_m_trust) + 
  plot_annotation(
    title = "STIMULUS B2-2 — CLASSIC EXCEL ERROR BARS"
  )

PLOT_b2_2_maker
###################################################



```


### B2-3 MAKER
```{r B2_3-MAKER}

#FILTER DATAFRAME
df <- df_graphs %>% filter(STIMULUS == "B2-3")

######### MAKER ATTRIBUTES ########################
vals = c("datacollar", "bluecollar")
leftside <- rep ("PROFESSIONAL",1 )
rightside <-rep ("LAYPERSON",1 ) 
b23_m_design <- ggplot(df, aes(y = MAKER_DESIGN, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-DESIGN")

b23_m_data <- ggplot(df, aes(y = MAKER_DATA, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-DATA")


leftside <- rep ("LEFT-WING",1 )
rightside <-rep ("RIGHT-WING",1 ) 
b23_m_politics <- ggplot(df, aes(y = MAKER_POLITIC, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-POLITICS")
  

leftside <- rep ("CONFRONTATIONAL",1 )
rightside <-rep ("DIPLOMATIC",1 ) 
b23_m_argue <- ggplot(df, aes(y = MAKER_ARGUE, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-ARGUE")
  
leftside <- rep ("ALTRUSITC",1 )
rightside <-rep ("SELFISH",1 ) 
b23_m_selfish <- ggplot(df, aes(y = MAKER_SELF, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-SELFISH")


leftside <- rep ("Does NOT",1 )
rightside <-rep ("DOES",1 ) 
b23_m_align <- ggplot(df, aes(y = MAKER_ALIGN, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-SHARES-MY-VALUES")

leftside <- rep ("UNTRUSTWORTHY",1 )
rightside <-rep ("TRUSTWORTHY",1 ) 
b23_m_trust <- ggplot(df, aes(y = MAKER_TRUST, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-TRUST")


PLOT_b2_3_maker <- (b23_m_design / b23_m_data / b23_m_politics / b23_m_argue / b23_m_selfish / b23_m_align / b23_m_trust) + 
  plot_annotation(
    title = "STIMULUS B2-3 — HOT DESERT CLIMATE MAP"
  )

PLOT_b2_3_maker
###################################################



```

### B2-4 MAKER
```{r B2_4-MAKER}

#FILTER DATAFRAME
df <- df_graphs %>% filter(STIMULUS == "B2-4")

######### MAKER ATTRIBUTES ########################
vals = c("datacollar", "bluecollar")
leftside <- rep ("PROFESSIONAL",1 )
rightside <-rep ("LAYPERSON",1 ) 
b24_m_design <- ggplot(df, aes(y = MAKER_DESIGN, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-DESIGN")

b24_m_data <- ggplot(df, aes(y = MAKER_DATA, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-DATA")


leftside <- rep ("LEFT-WING",1 )
rightside <-rep ("RIGHT-WING",1 ) 
b24_m_politics <- ggplot(df, aes(y = MAKER_POLITIC, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-POLITICS")
  

leftside <- rep ("CONFRONTATIONAL",1 )
rightside <-rep ("DIPLOMATIC",1 ) 
b24_m_argue <- ggplot(df, aes(y = MAKER_ARGUE, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-ARGUE")
  
leftside <- rep ("ALTRUSITC",1 )
rightside <-rep ("SELFISH",1 ) 
b24_m_selfish <- ggplot(df, aes(y = MAKER_SELF, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-SELFISH")


leftside <- rep ("Does NOT",1 )
rightside <-rep ("DOES",1 ) 
b24_m_align <- ggplot(df, aes(y = MAKER_ALIGN, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-SHARES-MY-VALUES")

leftside <- rep ("UNTRUSTWORTHY",1 )
rightside <-rep ("TRUSTWORTHY",1 ) 
b24_m_trust <- ggplot(df, aes(y = MAKER_TRUST, x = ID.Study, color = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-TRUST")


PLOT_b2_4_maker <- (b24_m_design / b24_m_data / b24_m_politics / b24_m_argue / b24_m_selfish / b24_m_align / b24_m_trust) + 
  plot_annotation(
    title = "STIMULUS B2-4 — HOLMES HOSPITAL BEDS"
  )

PLOT_b2_4_maker
###################################################

```




## BLOCK 6

### B6-1 MAKER
```{r B6_1-MAKER}

#FILTER DATAFRAME
df <- df_graphs %>% filter(STIMULUS == "B6-1")

######### MAKER ATTRIBUTES ########################
# vals = c("datacollar", "bluecollar")
leftside <- rep ("PROFESSIONAL", 1 )
rightside <-rep ("LAYPERSON", 1 ) 
b61_m_design <- ggplot(df, aes(y = MAKER_DESIGN, x = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  # #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  # #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-DESIGN")

b61_m_data <- ggplot(df, aes(y = MAKER_DATA, x = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  # #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  # #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-DATA")


leftside <- rep ("LEFT-WING", 1 )
rightside <-rep ("RIGHT-WING", 1 ) 
b61_m_politics <- ggplot(df, aes(y = MAKER_POLITIC, x = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  # #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  # #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-POLITICS")
  

leftside <- rep ("CONFRONTATIONAL", 1 )
rightside <-rep ("DIPLOMATIC", 1 ) 
b61_m_argue <- ggplot(df, aes(y = MAKER_ARGUE, x = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  # #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  # #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-ARGUE")
  
leftside <- rep ("ALTRUSITC", 1 )
rightside <-rep ("SELFISH", 1 ) 
b61_m_selfish <- ggplot(df, aes(y = MAKER_SELF, x = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  # #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  # #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-SELFISH")


leftside <- rep ("Does NOT", 1 )
rightside <-rep ("DOES", 1 ) 
b61_m_align <- ggplot(df, aes(y = MAKER_ALIGN, x = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  # #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  # #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-SHARES-MY-VALUES")

leftside <- rep ("UNTRUSTWORTHY", 1 )
rightside <-rep ("TRUSTWORTHY", 1 ) 

b61_m_trust <-ggplot(df, aes(y = MAKER_TRUST, x = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  # #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  # #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-TRUST")


PLOT_b6_1_maker <- (b61_m_design / b61_m_data / b61_m_politics / b61_m_argue / b61_m_selfish / b61_m_align / b61_m_trust) + 
  plot_annotation(
    title = "STIMULUS B6-1 PLACID PURPLE PIES"
  )

PLOT_b6_1_maker
###################################################



```


### B6-2 MAKER
```{r B6_2-MAKER}

#FILTER DATAFRAME
df <- df_graphs %>% filter(STIMULUS == "B6-2")

######### MAKER ATTRIBUTES ########################
# vals = c("datacollar", "bluecollar")
leftside <- rep ("PROFESSIONAL", 1 )
rightside <-rep ("LAYPERSON", 1 ) 
b62_m_design <- ggplot(df, aes(y = MAKER_DESIGN, x = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  # #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  # #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-DESIGN")

b62_m_data <- ggplot(df, aes(y = MAKER_DATA, x = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  # #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  # #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-DATA")


leftside <- rep ("LEFT-WING", 1 )
rightside <-rep ("RIGHT-WING", 1 ) 
b62_m_politics <- ggplot(df, aes(y = MAKER_POLITIC, x = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  # #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  # #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-POLITICS")
  

leftside <- rep ("CONFRONTATIONAL", 1 )
rightside <-rep ("DIPLOMATIC", 1 ) 
b62_m_argue <- ggplot(df, aes(y = MAKER_ARGUE, x = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  # #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  # #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-ARGUE")
  
leftside <- rep ("ALTRUSITC", 1 )
rightside <-rep ("SELFISH", 1 ) 
b62_m_selfish <- ggplot(df, aes(y = MAKER_SELF, x = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  # #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  # #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-SELFISH")


leftside <- rep ("Does NOT", 1 )
rightside <-rep ("DOES", 1 ) 
b62_m_align <- ggplot(df, aes(y = MAKER_ALIGN, x = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  # #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  # #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-SHARES-MY-VALUES")

leftside <- rep ("UNTRUSTWORTHY", 1 )
rightside <-rep ("TRUSTWORTHY", 1 ) 

b62_m_trust <-ggplot(df, aes(y = MAKER_TRUST, x = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  # #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  # #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-TRUST")


PLOT_b6_2_maker <- (b62_m_design / b62_m_data / b62_m_politics / b62_m_argue / b62_m_selfish / b62_m_align / b62_m_trust) + 
  plot_annotation(
    title = "STIMULUS B6-2 ECONOMIST BLUE BARS"
  )

PLOT_b6_2_maker
###################################################



```




### B6-3 MAKER
```{r B6-3-MAKER}

#FILTER DATAFRAME
df <- df_graphs %>% filter(STIMULUS == "B6-3")

######### MAKER ATTRIBUTES ########################
# vals = c("datacollar", "bluecollar")
leftside <- rep ("PROFESSIONAL", 1 )
rightside <-rep ("LAYPERSON", 1 ) 
b63_m_design <- ggplot(df, aes(y = MAKER_DESIGN, x = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  # #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  # #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-DESIGN")

b63_m_data <- ggplot(df, aes(y = MAKER_DATA, x = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  # #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  # #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-DATA")


leftside <- rep ("LEFT-WING", 1 )
rightside <-rep ("RIGHT-WING", 1 ) 
b63_m_politics <- ggplot(df, aes(y = MAKER_POLITIC, x = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  # #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  # #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-POLITICS")
  

leftside <- rep ("CONFRONTATIONAL", 1 )
rightside <-rep ("DIPLOMATIC", 1 ) 
b63_m_argue <- ggplot(df, aes(y = MAKER_ARGUE, x = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  # #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  # #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-ARGUE")
  
leftside <- rep ("ALTRUSITC", 1 )
rightside <-rep ("SELFISH", 1 ) 
b63_m_selfish <- ggplot(df, aes(y = MAKER_SELF, x = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  # #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  # #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-SELFISH")


leftside <- rep ("Does NOT", 1 )
rightside <-rep ("DOES", 1 ) 
b63_m_align <- ggplot(df, aes(y = MAKER_ALIGN, x = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  # #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  # #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-SHARES-MY-VALUES")

leftside <- rep ("UNTRUSTWORTHY", 1 )
rightside <-rep ("TRUSTWORTHY", 1 ) 

b63_m_trust <-ggplot(df, aes(y = MAKER_TRUST, x = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  # #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  # #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-TRUST")


PLOT_b6_3_maker <- (b63_m_design / b63_m_data / b63_m_politics / b63_m_argue / b63_m_selfish / b63_m_align / b63_m_trust) + 
  plot_annotation(
    title = "STIMULUS B6-3 FIERY OMBRE BARS"
  )

PLOT_b6_3_maker
###################################################



```







### B6-4 MAKER
```{r B6-4-MAKER}

#FILTER DATAFRAME
df <- df_graphs %>% filter(STIMULUS == "B6-4")

######### MAKER ATTRIBUTES ########################
# vals = c("datacollar", "bluecollar")
leftside <- rep ("PROFESSIONAL", 1 )
rightside <-rep ("LAYPERSON", 1 ) 
b64_m_design <- ggplot(df, aes(y = MAKER_DESIGN, x = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  # #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  # #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-DESIGN")

b64_m_data <- ggplot(df, aes(y = MAKER_DATA, x = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  # #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  # #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-DATA")


leftside <- rep ("LEFT-WING", 1 )
rightside <-rep ("RIGHT-WING", 1 ) 
b64_m_politics <- ggplot(df, aes(y = MAKER_POLITIC, x = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  # #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  # #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-POLITICS")
  

leftside <- rep ("CONFRONTATIONAL", 1 )
rightside <-rep ("DIPLOMATIC", 1 ) 
b64_m_argue <- ggplot(df, aes(y = MAKER_ARGUE, x = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  # #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  # #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-ARGUE")
  
leftside <- rep ("ALTRUSITC", 1 )
rightside <-rep ("SELFISH", 1 ) 
b64_m_selfish <- ggplot(df, aes(y = MAKER_SELF, x = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  # #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  # #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-SELFISH")


leftside <- rep ("Does NOT", 1 )
rightside <-rep ("DOES", 1 ) 
b64_m_align <- ggplot(df, aes(y = MAKER_ALIGN, x = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  # #breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  # #breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-SHARES-MY-VALUES")

leftside <- rep ("UNTRUSTWORTHY", 1 )
rightside <-rep ("TRUSTWORTHY", 1 ) 

b64_m_trust <-ggplot(df, aes(y = MAKER_TRUST, x = ID.Study))+
  geom_jitter(width = 0.1, alpha=0.5) + 
  scale_y_continuous(limits=c(-1,101)) +
  labs(x="", y="") +
  coord_flip() + 
  theme_minimal() + 
  easy_remove_legend() + 
  guides(
  y = guide_axis_manual(
  # breaks = vals, 
  labels = leftside  
  ),
  y.sec = guide_axis_manual(
  # breaks = vals, 
  labels = rightside
)) + 
  labs(title  = "MAKER-TRUST")


PLOT_b6_4_maker <- (b64_m_design / b64_m_data / b64_m_politics / b64_m_argue / b64_m_selfish / b64_m_align / b64_m_trust) + 
  plot_annotation(
    title = "STIMULUS B6-4 DIRTY STACKED CIGARETTES"
  )

PLOT_b6_4_maker
###################################################



```









## POLITICS



```{r}



p_politics <- b00_m_politics / b11_m_politics / b12_m_politics / b13_m_politics / b14_m_politics / b21_m_politics / b22_m_politics / b23_m_politics / b24_m_politics /b61_m_politics / b62_m_politics / b63_m_politics / b64_m_politics 

p_politics

```



```{r}

# gf_histogram( ~ MAKER_TRUST, data = df_graphs) %>% 
#   gf_facet_grid(STIMULUS ~ .) %>%  easy_labs( title = "MAKER TRUST by GRAPH")
# 
# gf_histogram( ~ CHART_TRUST, data = df_graphs) %>% 
#   gf_facet_grid(STIMULUS ~ .) %>%  easy_labs( title = "CHART TRUST by GRAPH")
# 
# 
# gf_histogram( ~ MAKER_CONF, data = df_graphs) %>%  easy_labs( title = "MAKER CONF by GRAPH")
# # %>% 
#   gf_facet_grid(STIMULUS ~ .) 
# 

```

```{r, message=FALSE, warning=FALSE}

# #MAKER CHARS 
# df <- df_graphs %>% select(ID.Study:STIMULUS, ENCOUNTER, MAKER_ID:MAKER_LATENCY) %>% 
#   mutate(
#     STIMULUS = factor(STIMULUS) #refactor to get rid of extra empty levels 
#   )
# 
# #MAKER CHARS 
# df <- df_graphs %>% select(ID.Study:STIMULUS, ENCOUNTER, MAKER_ID:MAKER_LATENCY) %>% 
#   mutate(
#     STIMULUS = factor(STIMULUS) #refactor to get rid of extra empty levels 
#   )
# 
# ## CHART 
# df <- df_graphs %>% select(ID.Study, STIMULUS, ENCOUNTER, CHART_LIKE:loop_number) %>% 
#   mutate(
#     STIMULUS = factor(STIMULUS) #refactor to get rid of extra empty levels 
#   )
# 
# ggpairs(df, mapping = aes(color = STIMULUS)) 
# 




## MAKER CHARACTERISTICS 
df_1 <- df_graphs %>% 
  # filter(STIMULUS == "B0-0") %>% 
  select(ID.Study, MAKER_ID, MAKER_AGE, MAKER_GENDER, 
         MAKER_DESIGN: MAKER_TRUST)
         

g <- ggpairs(df_1, 
        mapping = aes(color = ID.Study, alpha = 0.05),
        showStrips = TRUE,
        title = "STIMULUS 0 MAKER CHARACTERISTICS BY SAMPLE") + 
    theme_minimal()


g
```

# MODELLING

```{r, message=FALSE}

##STATSPLOT
grouped_ggwithinstats(
  data  = df_graphs,
  x     = STIMULUS,
  y     = CHART_TRUST,
  grouping.var = ID.Study
) 

grouped_ggscatterstats(
  data = df_graphs, ## data frame from which variables are taken
  x = CHART_BEAUTY, ## predictor/independent variable
  y = CHART_TRUST, ## dependent variable
  grouping.var = ID.Study,
  xlab = "CHART BEAUTY", ## label for the x-axis
  ylab = "CHART TRUST", ## label for the y-axis
  # label.expression = rating < 5 & budget > 100, ## expression for deciding which points to label
  point.label.args = list(alpha = 0.7, size = 4, color = "grey50"),
  xfill = "#CC79A7", ## fill for marginals on the x-axis
  yfill = "#009E73" ## fill for marginals on the y-axis
  # title = "CHART TRUST (VS) MAKER TRUST",
  # caption = ""
)

gf_point( data = df_graphs, CHART_TRUST~MAKER_TRUST, color = ~STIMULUS) %>% gf_facet_wrap(~STIMULUS)


grouped_ggscatterstats(
  data = df_graphs, ## data frame from which variables are taken
  x = MAKER_TRUST, ## predictor/independent variable
  y = CHART_TRUST, ## dependent variable
  grouping.var = ID.Study,
  xlab = "MAKER TRUST", ## label for the x-axis
  ylab = "CHART TRUST", ## label for the y-axis
  # label.expression = rating < 5 & budget > 100, ## expression for deciding which points to label
  point.label.args = list(alpha = 0.7, size = 4, color = "grey50"),
  xfill = "#CC79A7", ## fill for marginals on the x-axis
  yfill = "#009E73" ## fill for marginals on the y-axis
  # title = "CHART TRUST (VS) MAKER TRUST",
  # caption = ""
)

gf_point( data = df_graphs, MAKER_TRUST~CHART_TRUST, color = ~STIMULUS) %>% gf_facet_wrap(~STIMULUS)



grouped_ggscatterstats(
  data = df_graphs, ## data frame from which variables are taken
  x = CHART_BEAUTY, ## predictor/independent variable
  y = MAKER_ALIGN, ## dependent variable
  grouping.var = ID.Study,
  xlab = "CHART BEAUTY", ## label for the x-axis
  ylab = "MAKER ALIGN", ## label for the y-axis
  # label.expression = rating < 5 & budget > 100, ## expression for deciding which points to label
  point.label.args = list(alpha = 0.7, size = 4, color = "grey50"),
  xfill = "#CC79A7", ## fill for marginals on the x-axis
  yfill = "#009E73" ## fill for marginals on the y-axis
  # title = "CHART TRUST (VS) MAKER TRUST",
  # caption = ""
)


gf_point( data = df_graphs, MAKER_ALIGN~CHART_BEAUTY, color = ~STIMULUS) %>% gf_facet_wrap(~STIMULUS)






ggscatterstats(
  data = df_graphs %>% filter(STIMULUS=="B0-0"), ## data frame from which variables are taken
  x = CHART_BEAUTY, ## predictor/independent variable
  y = MAKER_TRUST, ## dependent variable
  xlab = "CHART BEAUTY", ## label for the x-axis
  ylab = "MAKER TRUST", ## label for the y-axis
  # label.expression = rating < 5 & budget > 100, ## expression for deciding which points to label
  point.label.args = list(alpha = 0.7, size = 4, color = "grey50"),
  xfill = "#CC79A7", ## fill for marginals on the x-axis
  yfill = "#009E73" ## fill for marginals on the y-axis
  # title = "CHART TRUST (VS) MAKER TRUST",
  # caption = ""
)

gf_point( data = df_graphs %>% filter(STIMULUS=="B0-0"), CHART_TRUST~CHART_BEAUTY, color = ~STIMULUS) %>% gf_facet_wrap(~STIMULUS)

gf_point( data = df_graphs %>% filter(STIMULUS=="B0-0"), MAKER_TRUST~CHART_BEAUTY, color = ~STIMULUS) %>% gf_facet_wrap(~STIMULUS)


```


```{r}


#TODO CENTERING AND NORMALIZING

### little model
df <- df_graphs %>% filter(STIMULUS == "B0-0")
m <- lm( CHART_TRUST ~ CHART_BEAUTY,data = df)
summary(m)
ggnostic(m) #GGALLY MODEL CHECKS
check_model(m) #EASY STATS MODEL CHECKS 

report(m)
```


```{r}
### MORE COMPLEX MODEL
df <- df_graphs %>% filter(STIMULUS != "B0-0")
m1 <- lmer(CHART_TRUST ~ CHART_BEAUTY + (1|ID.Qualtrics), data = df)
m2 <- lmer(CHART_TRUST ~ CHART_BEAUTY + (1|STIMULUS), data = df)
m3 <- lmer(CHART_TRUST ~ CHART_BEAUTY + (1 | STIMULUS) + (1 | ID.Qualtrics), data = df)
summary(m1)
summary(m2)
summary(m3)
compare_parameters(m1,m2,m3)
compare_performance(m1,m2,m3, rank = TRUE)


m <- lmer(CHART_TRUST ~ CHART_BEAUTY + MAKER_TRUST + (1 | STIMULUS) ,  data = df)
mi <- lmer(CHART_TRUST ~ CHART_BEAUTY * MAKER_TRUST + (1 | STIMULUS) , data = df)
summary(m)
summary(mi)

compare_performance(m3,m,mi, rank = TRUE)

report(m)
#todo see https://yury-zablotski.netlify.app/post/mixed-effects-models-2/ about fitting with ML vs REML for model comparison 
```

```{r}
# #TODO WALK THROUGH THIS 
# #https://yury-zablotski.netlify.app/post/mixed-models/#multiple-random-slope-model
# 
# #load example data
# data("sleepstudy")
# 
# #fit the model
# m_slp <- lmer(Reaction ~ Days + (Days | Subject), sleepstudy)
# 
# #the next line put all the estimated intercept and slope per subject into a dataframe
# reaction_slp <- as.data.frame(t(apply(ranef(m_slp)$Subject, 1,function(x) fixef(m_slp) + x)))
# 
# #to get the predicted regression lines we need one further step, writing the linear equation: Intercept + Slope*Days with different coefficient for each subject
# pred_slp <- melt(apply(reaction_slp,1,function(x) x[1] + x[2]*0:9), value.name = "Reaction")
# 
# #some re-formatting for the plot
# names(pred_slp)[1:2] <- c("Days","Subject")
# pred_slp$Days <- pred_slp$Days - 1
# pred_slp$Subject <- as.factor(pred_slp$Subject)
# 
# #plot with actual data 
# ggplot(pred_slp,aes(x=Days,y=Reaction,color=Subject))+
#   geom_line()+
#   geom_point(data=sleepstudy,aes(x=Days,y=Reaction))+
#   facet_wrap(~Subject,nrow=3)

```
